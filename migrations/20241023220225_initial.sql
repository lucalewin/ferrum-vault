CREATE TABLE "accounts" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"email" TEXT NOT NULL UNIQUE,
	"password" TEXT NOT NULL,
	"created_at" DATE NOT NULL,
	"first_name" TEXT,
	"last_name" TEXT,
	"date_of_birth" DATE,
	"username" TEXT NOT NULL UNIQUE,
	"phone_number" TEXT,
	PRIMARY KEY("id")
);


CREATE TABLE "passwords" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"account_id" INTEGER NOT NULL,
	"email" TEXT NOT NULL,
	"password" TEXT NOT NULL,
	"name" TEXT NOT NULL,
	"url" TEXT NOT NULL,
	"note" TEXT,
	PRIMARY KEY("id")
);


CREATE TABLE "contacts" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"account_id" INTEGER NOT NULL,
	PRIMARY KEY("id")
);


CREATE TABLE "recovery_codes" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"account_id" INTEGER NOT NULL,
	"code" TEXT NOT NULL,
	"used" BOOLEAN NOT NULL,
	PRIMARY KEY("id")
);


CREATE TABLE "sessions" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"account_id" INTEGER NOT NULL,
	"token" TEXT NOT NULL,
	"expires" INTEGER NOT NULL,
	PRIMARY KEY("id")
);


ALTER TABLE "passwords"
ADD FOREIGN KEY("account_id") REFERENCES "accounts"("id")
ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE "contacts"
ADD FOREIGN KEY("account_id") REFERENCES "accounts"("id")
ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE "sessions"
ADD FOREIGN KEY("account_id") REFERENCES "accounts"("id")
ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE "recovery_codes"
ADD FOREIGN KEY("account_id") REFERENCES "accounts"("id")
ON UPDATE CASCADE ON DELETE CASCADE;